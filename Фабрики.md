## Паттерн Фабрика

Фабрики - это SO ( [Scriptable Object](https://unity3d.com/learn/tutorials/modules/beginner/live-training-archive/scriptable-objects) ) отвечающие за создание сложных композиций сущностей. Например фабрика врагов будет отвечать за создание сущностей врагов, а фабрика игрока за добавление героя и его интерфейса. Фабрики не являются обязательным элементом однако позволяют сделать код чище за счет убирания шаблонного кода создания различных сущностей. Помимо прочего будучи ассетом фабрика может хранить различные переменные настроек и префабов. 

Так как природа фреймворка основана на главенстве композиции - фабрики идеальные кандидаты для сборки сущностей с добавлением различного функционала на лету : например через фабрику мы можем попросить создать разновидность меча который умеет говорить и давать задания. 

Фабрики добавляются в Starter классы в лист fabrics. Оттуда стартер добавляет их в Toolbox.

![Настройка фабрик](https://i.gyazo.com/423bdd1f93cf9411ffa71c682a255fe8.png)

![Настройка фабрик 2](https://i.gyazo.com/b948ac1682bedaeb67f97d11c1320bc8.png)



```csharp
// где-то в игре создаем героя
   Toolbox.Get<FactoryPlayer>().Spawn<ActorPlayer>(spawner.selfTransform.position, Quaternion.identity);
```

```csharp
// что стоит за строчкой выше
namespace Homebrew
{
    [CreateAssetMenu(fileName = "Factory Player", menuName = "Actors/Factories/Player")]
    public class FactoryPlayer : Factory
    {
        public GameObject prefab_player;
        public GameObject prefab_ui_player;
        public GameObject prefab_ui_player_melee;

        public override T Spawn<T>(Vector3 pos, Quaternion rot)
        {
            T go = null;
            if (typeof(T) == typeof(ActorPlayer))
            {
                CreateUI();
                go = this.Populate<T>(Pool.Entities, prefab_player, pos, rot);
            }

            return go;
        }

        void CreateUI()
        {
            this.Populate(Pool.UI, prefab_ui_player);
            this.Populate(Pool.UI, prefab_ui_player_melee);
        }
    }
}
```

Вы можете использовать свои методы Spawn внутри фабрики.( не обязательно использовать override T Spawn метод ) 

## Как создавать фабрики
Процесс создания фабрик такой же как и любых SO.

Однако в фреймворке есть быстрый метод автогенерации.
Кликните ( выделите ) папку [1]Source или ту папку в которой вы храните код. 
После этого жмите Tools->Actors->Add->Factory
[![Создание фабрики](https://i.gyazo.com/6fa7c595971249fd21f1d852a197ca6f.gif)](https://gyazo.com/6fa7c595971249fd21f1d852a197ca6f) 

Внутри папки Source появится скрипт- в зависимости от того как вы его назовете он появится в создании ассетов.
Чтобы создать новый ассет выберете папку где вы храните ассеты. По умолчанию это [2]Content/Resources/Data
ПКМ по папке и Create->Actors->Factories->Название Фабрики. После этого ваш ассет будет создан.

Обычный способ создания фабрики будет ручное написание скрипта фабрики:

```csharp
// добавляем атрибут CreateAssetMenu 
// fileName - как по умолчанию называется новый ассет.
// menuName - откуда в меню создания мы будет выбирать ассет.
  [CreateAssetMenu(fileName = "Factory Player", menuName = "Actors/Factories/Player")]
// наследуемся от Factory   
 public class FactoryPlayer : Factory
    {
```

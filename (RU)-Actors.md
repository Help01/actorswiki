# Акторы
Актор (Actor) служит мостом между фреймворком и физическим объектом в Unity. Задача актора визуально настроить базовые компоненты сущности, инициализировать сущность. 

## Создание

> Акторы самостоятельно создают сущность.

### Динамическое создание  

#### Вариант 1
Вернет нового актора и назначит ему новый игровой объект (gameobject). Объект будет получен из папки Resources по имени.
```csharp
public void Setup()
{
   Actor a = Actor.Create("Obj Alpaca");
}
```
#### Вариант 2
Вернет нового актора и назначит ему новый игровой объект (gameobject). Объект будет получен из предоставленного разработчиком префаба (prefab).
```csharp
public GameObject prefabFluffyUnicorn;
public void Setup()
{    
     Actor a = Actor.Create(prefabFluffyUnicorn);
}
```

_На заметку:_  
> При создании объекта вышеуказанными способами идет проверка на наличие компонента Актора у префаба. Если компонента нет, то актор будет динамически добавлен на созданный объект. Старайтесь избегать таких ситуаций, так как проверка на наличие компонента дешевле чем динамическое добавление. Хорошим тоном будет добавить актора на префаб.

### Размещение на сцене  

Добавьте Actor-компонент(Класс Actor или его наследник) на gameobject в сцене (или на префаб этого go), воспользовавшись кнопкой Add Component.  Инициалиализация актора произойдет автоматически из стартера.

## Настройка сущности через актора

### Вариант 1 - наследование от актора
В этом варианте создается новый класс, который наследуется от класса `Actor`. Это самый простой способ работы с акторами. Добавляются поля компонентов которые нужно передать сущности:

```csharp
public class ActorUnit : Actor
{
  [FoldoutGroup("Setup")]
  public ComponentCollider componetCollider;
  [FoldoutGroup("Setup")]
  public ComponentObject componentObject;
}
```

Дальше используется метод `Setup()` для установки компонентов сущности:

```csharp
public class ActorUnit : Actor
{

  [FoldoutGroup("Setup")]
  public ComponentCollider componetCollider;
  [FoldoutGroup("Setup")]
  public ComponentObject componentObject;

  protected override void Setup()
  {
     // добавит компонент
     entity.Set(componetCollider);
     entity.Set(componentObject);
    
     // создаст и добавит компонент по типу
     entity.Set<ComponentMotion>();
    
     // добавит тэг
     entity.Set(Tag.Alpaca);
  }
 
}
```

### Вариант 2 - модели

Вернет нового актора и назначит ему новый игровой объект (gameobject). Объект будет получен из папки Resources по имени.
Настройки для актора будут взяты из `Model.Bunny`
```csharp
Actor.Create("Obj Unit", Model.Bunny);
Actor.Create("Obj Sprite", Model.Bunny);
```
Ознакомьтесь с [настройкой через модели](https://github.com/dimmpixeye/ecs/wiki/(RU)-Models).

_На заметку:_  
> Для полноценной работы актора необязательно наследоваться. Если вы будете использовать вариант через модели, то на объекте достаточно иметь базовый компонент Актора.
 
## Как уничтожать Акторов
Напрямую уничтожение актора, как go или компонента, не потребуется. Как правило в фреймворке вы будете иметь дело с сущностями. Для уничтожения вам нужно вызвать `entity.Release()` метод:  

```csharp
           Actor a = Actor.Create(prefabFluffyUnicorn);
           a.entity.Release();
```

_На заметку_
> Любое логические действие уничтожения и удаления в фреймворке идет через методы `Release()`- если видите этот метод, то он 100% связан с уничтожением.

### Что происходит при уничтожении актора

* С уничтожением актора его сущность сбрасывается в область зарезервированных сущностей. Все новые сущности сначала попытаются получить индекс оттуда.
* Все компоненты уничтоженной сущности помечаются как неактивные. Сущность выходит из обращения всех групп. При этом отрабатываются все события выхода из групп если такие присутстввуют. 
* Если актор был использован в пуле объектов, то его GameObject будет деактивирован для последующего использования. 

> Уничтожение является отложенным действием и произойдет на следующий кадр.


## Обращение к сущности из актора

```csharp
public GameObject prefabFluffyUnicorn;
public void Setup()
{    
     ref ent e = ref Actor.Create(prefabFluffyUnicorn).entity;
}
```

